Bootstrap: docker
From: nvidia/cuda:12.4.0-devel-ubuntu22.04

%post
    apt update
    DEBIAN_FRONTEND=NONINTERACTIVE apt install -y libgl1 libglib2.0-0 \
        python3.11 python3.11-venv python3.11-dev
    mkdir /opt/venv
    python3.11 -m venv /opt/venv/mamba-ssm
    . /opt/venv/mamba-ssm/bin/activate
    pip install mamba-ssm causal-conv1d jupyterlab --no-cache-dir

%environment
    export PATH="/opt/venv/mamba-ssm/bin:$PATH"
    export PYTHONPATH="$PYTHONPATH:/opt/venv/mamba-ssm/bin"

%labels
  author Jenny Fothergill <jennyfothergill@boisestate.edu>
  github.com/bsurc/container git rev={{GIT_REV}}
