bootstrap: docker
from: mambaorg/micromamba:2-cuda12.4.1-ubuntu22.04

%post
    export CONDA_OVERRIDE_CUDA="12.4"
    micromamba install -qy -c nvidia -c conda-forge tensorflow=*=*cuda* \
        cudatoolkit cuda-nvcc matplotlib numpy pandas ipykernel pytorch \
        torchvision tensorboard scikit-learn jupyterlab notebook
    micromamba clean --all --yes

%environment
    export XLA_FLAGS='--xla_gpu_cuda_data_dir=/opt/conda/pkgs/cuda-nvcc-12.4.131-0'

%labels
  author Jenny Fothergill <jennyfothergill@boisestate.edu>
  github.com/bsurc/container git rev={{GIT_REV}}
